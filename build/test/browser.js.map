{"version":3,"file":"browser.js","sources":["../../source/test/load-script.ts","../../source/types.ts","../../source/css/document-index.ts","../../source/html/index.ts","../../source/get-template.ts","../../source/config.ts","../../source/handle-user.ts","../../source/delete-user.ts","../../source/element.ts","../../source/test/browser.ts","../../source/test/slots.ts","../../source/test/dispatch-event.ts","../../source/test/fake-data.ts"],"sourcesContent":["import * as VBM from 'vamtiger-browser-method/build/types';\nimport { expect } from 'chai';\n\nconst { VamtigerBrowserMethod } = window;\nconst { loadScript } = VamtigerBrowserMethod;\n\nexport default () => describe('vamtiger-user-registry', function () {\n    before(async function () {\n        await loadScript({\n            src: 'vamtiger-user-registry.js'\n        });\n    });\n\n    it('load script', async function() {\n        const script = document.head.querySelector('[src=\"vamtiger-user-registry.js\"]');\n\n        expect(script instanceof HTMLScriptElement).to.be.true;\n    });\n});","import * as VBM from 'vamtiger-browser-method/build/types';\nimport VamtigerUserRegistry from './element';\n\nexport enum StringConstant {\n    nothing = ''\n}\n\nexport enum Selector {\n    shadowUi = '[data-vamtiger-user-listing]',\n    style = 'style',\n    user = '[data-user]',\n    footer = '[data-footer]',\n    overlay = '[data-overlay]',\n    confirmDialog = '[data-confirm-dialog]',\n    confirmDeleteDialog = '[data-confirm-delete-user]',\n    confirmAddNewUserDialog = '[data-confirm-add-new-user]',\n    cancelDialog = '[data-confirm-button-cancel]',\n    confirmButtonOkay = '[data-confirm-button-ok]',\n    addNewUserButton = '[data-action-add-user]',\n    addNewUserForm = '[data-add-new-user-form]',\n    addNewUserFormError = '[data-error]',\n    addNewUserFormInputError = 'input[data-error]',\n    layoutMarkersToggle = '[data-layout-markers-toggle]'\n}\n\nexport enum EventName {\n    connected = 'vamtiger-user-registry-connected',\n    addUser = 'vamtiger-user-registry-add-user',\n    userAdded = 'vamtiger-user-registry-user-added'\n}\n\nexport enum RequestMethod {\n    DELETE = 'DELETE',\n    GET = 'GET',\n    POST = 'POST',\n    PUT = 'PUT'\n}\n\nexport enum ObservedAttributes {\n}\n\nexport enum SlotName {\n    headerImage = 'header-image',\n    headerCapation = 'header-caption',\n    action = 'action',\n    user = 'user',\n    overlay = 'overlay',\n    footer = 'footer'\n}\n\nexport interface IGetTemplate {\n    selector: Selector;\n    attributes?: IAttributes;\n    properties?: IProperties;\n}\n\nexport interface IAttributes {\n    id?: string;\n    for?: string;\n    name?: string;\n    slot?: string;\n}\n\nexport interface IProperties {\n    innerHTML?: string;\n}\n\nexport interface IDeleteUser {\n    element: VamtigerUserRegistry;\n    userElement?: HTMLElement;\n}\n\nexport interface ICloseConfirmation {\n    element: VamtigerUserRegistry;\n}\n\nexport interface IUserRegistryElementDataset extends DOMStringMap{\n    connected?: string;\n    getUsersUrl?: string;\n    getUserUrl?: string;\n    getUsersError?: string;\n    getAllUsers?: string;\n    deleteUserUrl?: string;\n    addNewUserUrl?: string;\n    handleUserTimeot?: string;\n    hover?: string;\n    confirm?: 'Delete user' | 'Add new user';\n    layoutMarkers?: string;\n    testMode?: string;\n    error?: string;\n    defaultErrorMessage?: string;\n}\n\nexport interface IHandleFooter {\n    element: VamtigerUserRegistry;\n    mutationLisit: MutationRecord[];\n    observer: MutationObserver;\n}\n\nexport interface IParams {\n    getUsersUrl: string;\n    getUserUrl: string;\n    getUsersNextPageUrl?: string;\n    getAllUsers?: boolean;\n\n    deleteUserUrl: string;\n\n    addNewUserUrl: string;\n\n    handleUserTimeout: number;\n\n    layoutMarkers: boolean;\n    testMode: boolean;\n}\n\nexport interface IUserRegistryElement extends HTMLElement {\n    dataset: UserRegistryElementDataset;\n}\n\nexport interface IGetUsers {\n    element: VamtigerUserRegistry;\n}\n\nexport interface IGetUser {\n    element: VamtigerUserRegistry;\n    userId: number;\n}\n\nexport interface IUser {\n    id: number;\n    name: string;\n    surname: string;\n    email: string;\n    position: string;\n}\n\nexport interface IGetUserSuccessResponse {\n    result: 'successful',\n    message: 'retrieved user(s)',\n    data: {\n        user: IUser\n    }\n}\n\nexport interface IGetUserFailedResponse {\n    \"result\": \"failed\",\n    \"message\": \"retrieved user(s) failed\",\n    \"data\": {\n        \"user\": 102\n    }\n}\n\nexport interface IResponseBase {\n    result: 'successful' | 'failed' | 'error';\n    message: string;\n}\n\nexport interface IUsersResponse extends IResponseBase {\n    data: {\n        users: {\n            current_page: number;\n            from: number;\n            last_page: number;\n            per_page: number;\n            to: number;\n            total: number;\n\n            first_page_url: string;\n            last_page_url: string;\n            next_page_url: string;\n            path: string;\n            prev_page_url: string | null;\n\n            data: IUser[]\n        }\n    }\n}\n\nexport interface IDeleteUserResponse extends IResponseBase {\n    data: {\n        user: number;\n        delete: number;\n    }\n}\n\nexport interface IAddNewUserSuccessResponse {\n    result: 'successful';\n    message: 'added new user',\n    data: {\n        user: number\n    }\n}\n\nexport interface IAddNewUserFailedResponse {\n    result: 'failed';\n    message: 'failed to add new user',\n    data: {\n        [key: string]: {\n            error: string;\n            errorDescription?: string;\n        }[]\n    }\n}\n\nexport interface IHandleUser {\n    element: VamtigerUserRegistry;\n    user: IUser;\n}\n\nexport interface IAddNewUser {\n    element: VamtigerUserRegistry;\n}\n\nexport interface IAddUserEventMessage extends CustomEventInit {\n    user?: IUser;\n}\n\nexport interface IHandleEvent {\n    element: VamtigerUserRegistry;\n    event: CustomEventInit<IAddUserEventMessage>\n}\n\ntype UserRegistryElementDataset = {[K in keyof IUserRegistryElementDataset]: IUserRegistryElementDataset[K]};\n\nexport type AttributesKey = keyof IAttributes;\n\nexport type ObservedAttribute = keyof typeof ObservedAttributes;\n\nexport type AddNewUserResponse = IResponseBase\n    & (IAddNewUserSuccessResponse | IAddNewUserFailedResponse);\n\nexport type GetNewUserResponse = IResponseBase\n    & (IGetUserSuccessResponse | IGetUserFailedResponse)\n\nexport type GetTemplate<P extends IGetTemplate> =\n    P['selector'] extends Selector.style ? HTMLStyleElement :\n    P['selector'] extends Selector.addNewUserButton ? HTMLButtonElement :\n    P['selector'] extends Selector.confirmDialog\n        | Selector.shadowUi\n        | Selector.user\n        | Selector.confirmDeleteDialog\n        | Selector.confirmAddNewUserDialog\n        ? HTMLDivElement :\n    null;","export default `vamtiger-user-registry button,vamtiger-user-registry fieldset,vamtiger-user-registry form,vamtiger-user-registry input,vamtiger-user-registry label{margin:nonne;padding:none;border:none;outline:none;-webkit-appearance:none}vamtiger-user-registry button{cursor:pointer}@-webkit-keyframes a{0%{opacity:0;visibility:hidden}to{opacity:1;visibility:visible}}@keyframes a{0%{opacity:0;visibility:hidden}to{opacity:1;visibility:visible}}@-webkit-keyframes b{0%{top:2em;opacity:0}to{top:0;opacity:1}}@keyframes b{0%{top:2em;opacity:0}to{top:0;opacity:1}}vamtiger-user-registry [data-button],vamtiger-user-registry form input,vamtiger-user-registry form label{cursor:pointer}vamtiger-user-registry [data-display-grid]{display:grid}vamtiger-user-registry [data-position-relative]{position:relative}vamtiger-user-registry [slot=user]{position:relative;overflow:hidden}vamtiger-user-registry [slot=user] *{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}vamtiger-user-registry [slot=user]:nth-child(odd){background-color:#d3d3d3}vamtiger-user-registry [slot=user]:nth-child(2n),vamtiger-user-registry [slot=user] [data-delete]{background-color:#fff}vamtiger-user-registry [slot=user] [data-delete]{display:grid;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:absolute;height:100%;width:2em;top:0;right:-2em;-webkit-transition:right 235ms;transition:right 235ms;color:red;font-size:1.5em;pointer-events:none}vamtiger-user-registry [slot=user][data-hover] [data-delete]{right:0}vamtiger-user-registry [slot=overlay]{visibility:hidden;position:relative;grid-row:1;grid-column:1}vamtiger-user-registry [slot=overlay] [data-confirm-header]{font-size:1.5em}vamtiger-user-registry [slot=overlay] [data-confirm-body]{font-size:1.1em;margin-bottom:1em}vamtiger-user-registry [slot=overlay] [data-header-underline]{height:1px;background-color:#d3d3d3}vamtiger-user-registry [slot=overlay] [data-confirm-footer]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}vamtiger-user-registry [slot=overlay] [data-confirm-footer] [data-confirm-button]{display:grid;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:8em;height:3.4em}vamtiger-user-registry [slot=overlay] [data-confirm-footer] [data-confirm-button][data-confirm-button-ok]{color:#fff;background-color:#000}vamtiger-user-registry [slot=overlay] [data-confirm-footer] [data-confirm-button][data-confirm-button-cancel]{color:gray;background-color:#fff}vamtiger-user-registry [slot=overlay] [data-confirm-footer] [data-confirm-button]:hover{-webkit-filter:inver(1);filter:inver(1)}vamtiger-user-registry [slot=overlay] [data-confirm-footer] [data-confirm-button]:nth-child(n+2){margin-right:1em}vamtiger-user-registry input{border:1px solid #000}vamtiger-user-registry [data-confirm-body] [data-confirm-input-form]{grid-row-gap:1em}vamtiger-user-registry [data-confirm-body] [data-confirm-input-form] [form-group]{display:grid;grid-row-gap:.5em;position:relative;grid-auto-rows:minmax(1.2em,auto)}vamtiger-user-registry [data-confirm-body] [data-confirm-input-form] [form-group] input{padding:.4em;font-size:1em}vamtiger-user-registry [data-confirm-body] [data-confirm-input-form] [form-group] input[data-error]~[data-error]:after{display:inline-block;content:attr(data-error);font-size:.8em;color:red}vamtiger-user-registry[data-connected]{-webkit-animation:a 387ms linear forwards;animation:a 387ms linear forwards}vamtiger-user-registry[data-confirm] [slot=overlay]{-webkit-animation:b 135ms;animation:b 135ms}vamtiger-user-registry[data-confirm=\"Add new user\"] [data-confirm-add-new-user],vamtiger-user-registry[data-confirm=\"Delete user\"] [data-confirm-delete-user]{visibility:visible}vamtiger-user-registry[data-test-mode] [data-confirm-button-ok]{visibility:none;cursor:not-allowed}\n/* layout markers*/vamtiger-user-registry[data-layout-markers] [slot=overlay]>:nth-child(odd){background-color:#b0c4de}vamtiger-user-registry[data-layout-markers] [slot=overlay]>:nth-child(2n){background-color:#d3d3d3}vamtiger-user-registry[data-layout-markers] [slot=overlay] [data-add-new-user-form]>:nth-of-type(odd){background-color:#ffb6c1}vamtiger-user-registry[data-layout-markers] [slot=overlay] [data-add-new-user-form]>:nth-of-type(odd)>:nth-of-type(odd){background-color:#90ee90}vamtiger-user-registry[data-layout-markers] [slot=overlay] [data-add-new-user-form]>:nth-of-type(2n){background-color:#008b8b}vamtiger-user-registry[data-layout-markers] [slot=overlay] [data-add-new-user-form]>:nth-of-type(2n)>:nth-of-type(odd){background-color:#d3d3d3}\n/*# sourceMappingURL=document-index.ts.map */`;","export default `<div slot=\"overlay\" data-confirm-dialog data-confirm-add-new-user> <div data-confirm-header> Add new user </div> <div data-header-underline></div> <div data-confirm-body data-display-grid> <form data-add-new-user-form data-confirm-input-form data-display-grid> <div form-group> <label for=\"addNewUserNameInput\"> Name </label> <input id=\"addNewUserNameInput\" name=\"name\"> <span data-error></span> </div> <div form-group> <label for=\"addNewUserSurnameInput\"> Surname </label> <input id=\"addNewUserSurnameInput\" name=\"surname\"> <span data-error></span> </div> <div form-group> <label for=\"addNewUserEmailInput\"> Email </label> <input type=\"email\" id=\"addNewUserEmailInput\" name=\"email\"> <span data-error></span> </div> <div form-group> <label for=\"addNewUserPositionInput\"> Position </label> <input id=\"addNewUserPositionInput\" name=\"position\"> <span data-error data-default-error-message=\"Please enter your current position\"></span> </div> </form> </div> <div data-confirm-footer> <button data-confirm-button data-confirm-button-ok> <span>Confirm</span> </button> <button data-confirm-button data-confirm-button-cancel> <span>Cancel</span> </button> </div> </div> <div slot=\"overlay\" data-confirm-dialog data-confirm-delete-user> <div data-confirm-header> Confirm delete </div> <div data-header-underline></div> <div data-confirm-body> <span> Please confirm that you would like to delete this user. </span> </div> <div data-confirm-footer> <button data-confirm-button data-confirm-button-ok> <span>Confirm</span> </button> <button data-confirm-button data-confirm-button-cancel> <span>Cancel</span> </button> </div> </div> <button slot=\"action\" data-action-add-user>Add new user</button> <div data-user data-button></div> <div data-vamtiger-user-listing> <div data-test-mode> <span data-title> test mode </span> <div data-separator></div> <div data-layout-markers-controls> <span data-label> layout markers </span> <div data-layout-markers-toggle></div> </div> </div> <div data-header> <div data-header-overlay></div> <figure data-header-image> <slot name=\"header-image\"></slot> </figure> <div data-header-caption> <slot name=\"header-caption\"></slot> </div> </div> <div data-body> <div data-left-side-bar></div> <div data-user-listing> <div data-action> <slot name=\"action\"></slot> </div> <div data-users> <slot name=\"user\"></slot> </div> </div> <div data-right-side-bar></div> </div> <div data-footer> <a data-backend>Laravel</a> <span data-separator></span> <a data-frontend>Web Components</a> </div> <div data-overlay> <slot name=\"overlay\"></slot> </div> </div>`;","import {\n    IGetTemplate,\n    GetTemplate,\n    StringConstant,\n    AttributesKey\n} from './types';\nimport html from './html';\nimport css from './css';\n\nconst { nothing } = StringConstant;\nconst template = document.createElement('template');\nconst stylesheet = `<style>${css}</style>`\nconst templateHtml = [\n    stylesheet,\n    html\n].join(nothing);\n\ntemplate.innerHTML = templateHtml;\n\nexport default <P extends IGetTemplate>(params: P) => {\n    const {\n        selector,\n        attributes = {},\n        properties = {}\n    } = params;\n    const attributesKeys = Object.keys(attributes) as AttributesKey[]\n    const templateElement = template.content.querySelector(selector);\n    const currentTemplate = templateElement && templateElement.cloneNode(true) as GetTemplate<P>;\n\n    if (currentTemplate) {\n        Object.assign(currentTemplate, properties);\n\n        attributesKeys.forEach(key => attributes[key] && currentTemplate.setAttribute(key, attributes[key] || ''));\n    }\n\n    return currentTemplate;\n};","import {\n    ObservedAttributes,\n    ObservedAttribute,\n    EventName\n} from './types'\n\nexport const shadowRoot = {\n    mode: 'open'\n} as ShadowRootInit;\n\nexport const observedAttributes = Object.keys(ObservedAttributes) as ObservedAttribute[];\n\nexport const eventParams = {\n    bubbles: true\n};\n\nexport const customEvent = {\n    [EventName.connected]: new CustomEvent(EventName.connected, {\n        ...eventParams\n    })\n}\n\nexport const idleTimeout = 1;\n\nexport const footerObserver = {\n    attributes: true\n};\n\nexport const clickEventName = document.ontouchstart ? 'touchstart' : 'click';\n\nexport const dependencies = [\n    {\n        name: 'font-awesome',\n        href: 'https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css'\n    }\n]","import {\n    IHandleUser,\n    Selector,\n    SlotName,\n    EventName\n} from './types';\nimport {\n    eventParams\n} from './config';\nimport { idleTimeout, clickEventName } from './config';\nimport getTemplate from './get-template';\nimport { confirm as confirmDelete } from './delete-user';\n\nconst { requestIdleCallback } = self;\n\nexport default function (params: IHandleUser) {\n    if (requestIdleCallback) {\n        handleUser(params);\n    } else {\n        setTimeout(() => handleUser(params), idleTimeout);\n    }\n}\n\nfunction handleUser({element, user}: IHandleUser) {\n    const { name, surname, email } = user;\n    const ignore = Array\n        .from(element.user.values())\n        .some(({id}) => id === user.id);\n    const userTemplate = !ignore && [\n        `<span data-name>${name}</span>`,\n        `<span data-surname>${surname}</span>`,\n        `<span data-email>${email}</span>`,\n        '<span data-delete class=\"fa fa-trash\" aria-hidden=\"true\"></delete>'\n    ].join('');\n    const userElement = userTemplate  && getTemplate({\n        selector: Selector.user,\n        properties: {\n            innerHTML: userTemplate\n        },\n        attributes: {\n            slot: SlotName.user\n        }\n    });\n\n    if (userElement) {\n        element.user.set(userElement, user);\n\n        element.appendChild(userElement);\n\n        element.dispatchEvent(new CustomEvent(\n            EventName.userAdded,\n            {\n                ...eventParams,\n                detail: {user}\n            }\n        ));\n\n        userElement.addEventListener('mouseenter', () => userElement.dataset.hover = '');\n        userElement.addEventListener('mouseleave', () => delete userElement.dataset.hover);\n        userElement.addEventListener(clickEventName, () => confirmDelete({element, userElement}));\n    }\n}","import {\n    IUserRegistryElement,\n    IDeleteUser,\n    IDeleteUserResponse,\n    Selector,\n    RequestMethod\n} from './types';\nimport closeConfirmation from './close-confirmation';\n\nexport default async function ({element}: IDeleteUser) {\n    const { params, deleteUserElement: userElement } = element;\n    const { deleteUserUrl } = params;\n    const user = userElement && element.user.get(userElement);\n    const url = user?.id && `${deleteUserUrl}/${user.id}`;\n    const requestParams = {\n        method: RequestMethod.DELETE\n    }\n\n    let response: IDeleteUserResponse;\n\n    if (url) {\n        try {\n            response = await fetch(url, requestParams)\n                .then(response => response.json());\n\n            if (response.result === 'successful' && userElement) {\n                element.deleteUserElement = undefined;\n\n                element.user.delete(userElement);\n\n                userElement.parentElement?.removeChild(userElement);\n\n                closeConfirmation({element});\n            }\n        } catch(error) {\n            console.error('Delete Usesr error');\n            console.error(error);\n        }\n    }\n}\n\nexport function confirm({element, userElement}: IDeleteUser) {\n    const { shadowRoot } = element;\n    const dataset: IUserRegistryElement['dataset'] = element.dataset;\n    const overlay = shadowRoot?.querySelector<HTMLElement>(Selector.overlay);\n    const overlayDataset: IUserRegistryElement['dataset'] | undefined = overlay?.dataset;\n\n    if (overlayDataset) {\n        dataset.confirm = 'Delete user';\n        overlayDataset.confirm = dataset.confirm;\n        element.deleteUserElement = userElement;\n    }\n}","import {\n    IUserRegistryElement,\n    IParams,\n    IUser,\n    Selector,\n    ObservedAttribute,\n    EventName,\n    IAddUserEventMessage\n} from './types';\nimport css from './css/document-index';\nimport getTemplate from './get-template';\nimport {\n    shadowRoot as shadowRootConfig,\n    observedAttributes,\n    footerObserver as footerObserverConfig,\n    clickEventName,\n    dependencies,\n    customEvent\n} from './config';\nimport getUsers from './get-users';\nimport handleFooter from './handle-footer';\nimport closeConfirmation from './close-confirmation';\nimport deleteUser from './delete-user';\nimport addNewUser, { confirm as addNewUserConfirm } from './add-new-user';\nimport handleEvent from './handle-event';\n\nconst { VamtigerBrowserMethod } = self;\nconst { loadScript, intersectionObserver } = VamtigerBrowserMethod;\n\nexport const name = 'vamtiger-user-registry';\n\ncss && Promise\n    .all([...dependencies, { name, css }].map(loadScript))\n    .catch(console.error);\n\nexport default class VamtigerUserRegistry extends HTMLElement implements IUserRegistryElement {\n    readonly params: IParams;\n    user = new Map<HTMLElement, IUser>();\n    deleteUserElement?: HTMLElement;\n    requestUrls = new Set<string>();\n    footerObserver?: MutationObserver;\n\n    constructor() {\n        super();\n\n        const shadowRoot = this.attachShadow(shadowRootConfig);\n        const stylesheet = getTemplate({\n            selector: Selector.style\n        });\n        const ui = getTemplate({\n            selector: Selector.shadowUi\n        });\n        const elements = [\n            stylesheet,\n            ui\n        ];\n        const dataset: IUserRegistryElement['dataset'] = this.dataset;\n        const uiDatatset: IUserRegistryElement['dataset'] | undefined = ui?.dataset;\n        const {\n            getUsersUrl = '',\n            getUserUrl = '',\n            deleteUserUrl = '',\n            handleUserTimeout = 0,\n            addNewUserUrl = ''\n        } = dataset;\n\n        this.params = {\n            layoutMarkers: dataset.hasOwnProperty('layoutMarkers'),\n            testMode: dataset.hasOwnProperty('testMode'),\n            addNewUserUrl,\n            getUsersUrl,\n            getUserUrl,\n            deleteUserUrl,\n            handleUserTimeout: Number(handleUserTimeout),\n            getAllUsers: dataset.hasOwnProperty('getAllUsers') || !intersectionObserver\n        };\n\n        if (this.params.layoutMarkers && uiDatatset) {\n            uiDatatset.layoutMarkers = '';\n        }\n\n        if (this.params.testMode && uiDatatset) {\n            uiDatatset.testMode = '';\n        }\n\n        elements.forEach(element => element && shadowRoot.appendChild(element));\n    }\n\n    static get observedAttributes() {\n        return observedAttributes;\n    }\n\n    async connectedCallback() {\n        const element = this;\n        const { shadowRoot, params } = element;\n        const { testMode, layoutMarkers } = params;\n        const shadowUi = shadowRoot?.querySelector<HTMLElement>(Selector.shadowUi);\n        const layoutMarkersToggle = shadowRoot?.querySelector<HTMLElement>(Selector.layoutMarkersToggle);\n        const addNewUserButton = !element.querySelector<HTMLButtonElement>(Selector.addNewUserButton) && getTemplate({\n            selector: Selector.addNewUserButton\n        });\n        const confirmDeleteDialog = getTemplate({\n            selector: Selector.confirmDeleteDialog\n        });\n        const confirmAddNewUserDialog = getTemplate({\n            selector: Selector.confirmAddNewUserDialog\n        });\n        const confirmDeleteButton = confirmDeleteDialog\n            ?.querySelector<HTMLElement>(Selector.confirmButtonOkay)\n        const confirmAddNewUserButton = confirmAddNewUserDialog\n            ?.querySelector<HTMLElement>(Selector.confirmButtonOkay)\n        const elements = [\n            addNewUserButton,\n            confirmDeleteDialog,\n            confirmAddNewUserDialog\n        ];\n        const closeConfirmationElements = [\n            confirmDeleteDialog?.querySelector<HTMLElement>(Selector.cancelDialog),\n            confirmAddNewUserDialog?.querySelector<HTMLElement>(Selector.cancelDialog)\n        ];\n        const footer = shadowRoot?.querySelector<HTMLElement>(Selector.footer);\n        const dataset: IUserRegistryElement['dataset'] = this.dataset;\n\n        elements.forEach(currentElement => currentElement && element.appendChild(currentElement));\n\n        closeConfirmationElements.forEach(currentElement => currentElement && currentElement\n            .addEventListener(clickEventName, () => closeConfirmation({element})));\n\n        if (addNewUserButton) {\n            addNewUserButton.addEventListener(clickEventName, () => addNewUserConfirm({element}));\n        }\n\n        if (confirmDeleteButton) {\n            confirmDeleteButton.addEventListener(clickEventName, () => deleteUser({element}));\n        }\n\n        if (confirmAddNewUserButton) {\n            confirmAddNewUserButton.addEventListener(clickEventName, () => addNewUser({element}));\n        }\n\n        if (footer && intersectionObserver) {\n            this.footerObserver = new MutationObserver((mutationLisit, observer) => handleFooter({\n                element,\n                mutationLisit,\n                observer\n            }));\n\n            this.footerObserver.observe(footer, footerObserverConfig);\n            intersectionObserver.observe(footer);\n        } else {\n            dataset.getAllUsers = '';\n        }\n\n        if (testMode || layoutMarkers) {\n            layoutMarkersToggle?.addEventListener(clickEventName, () => {\n                if (shadowUi) {\n                    shadowUi.dataset.layoutMarkers = '';\n\n                    if (layoutMarkersToggle.dataset.hasOwnProperty('active')) {\n                        delete layoutMarkersToggle.dataset.active;\n                        delete element.dataset.layoutMarkers;\n                        delete shadowUi?.dataset.layoutMarkers;\n                    } else {\n                        layoutMarkersToggle.dataset.active = '';\n                        element.dataset.layoutMarkers = '';\n                    }\n                }\n            })\n        }\n\n        await getUsers({ element });\n\n        dataset.connected = '';\n\n        element.addEventListener(\n            EventName.addUser,\n            (event: CustomEventInit<IAddUserEventMessage>) => handleEvent({element, event}));\n\n        element.dispatchEvent(customEvent[\"vamtiger-user-registry-connected\"]);\n    }\n\n    attributeChangedCallback(name: ObservedAttribute, oldValue: string, newValue: string) {\n\n    }\n}","import { setup, run } from 'mocha';\nimport loadScript from './load-script';\nimport dispatchEvent from './dispatch-event';\nimport slots from './slots';\nimport fakeData from './fake-data';\nimport VamtigerUserRegistry, { name } from '../element';\nimport { Selector } from '../types';\n\nsetup('bdd');\n\nloadScript();\nslots();\ndispatchEvent();\nfakeData();\n\nrun();\n\nexport function getElement() {\n    const element = document.body.querySelector<VamtigerUserRegistry>(name);\n\n    return element;\n}\n\nexport function removeUsers() {\n    const element = getElement();\n\n    element && Array.from(element.querySelectorAll<HTMLElement>(Selector.user))\n        .forEach(userElement => {\n            element.removeChild(userElement);\n\n            element.user.delete(userElement);\n        });\n}","import * as VBM from 'vamtiger-browser-method/build/types';\nimport { expect } from 'chai';\nimport { EventName, SlotName } from '../types';\nimport VamtigerUserRegistry, { name } from '../element';\n\nexport default () => describe('named slots', function () {\n    let element: VamtigerUserRegistry | undefined;\n\n    before(function () {return new Promise(resolve => {\n        element = document.createElement(name) as VamtigerUserRegistry;\n\n        element.addEventListener(EventName.connected, resolve);\n\n        document.body.appendChild(element);\n    })});\n\n    after(function () {\n        element?.parentElement?.removeChild(element);\n    })\n\n    it(SlotName.headerImage, async function() {\n        const selector = `slot[name=\"${SlotName.headerImage}\"]`;\n\n        expect(element?.shadowRoot?.querySelector(selector))\n            .to.be.ok;\n    });\n\n    it(SlotName.headerCapation, async function() {\n        const selector = `slot[name=\"${SlotName.headerCapation}\"]`;\n\n        expect(element?.shadowRoot?.querySelector(selector))\n            .to.be.ok;\n    });\n\n    it(SlotName.action, async function() {\n        const selector = `slot[name=\"${SlotName.action}\"]`;\n\n        expect(element?.shadowRoot?.querySelector(selector))\n            .to.be.ok;\n    });\n\n    it(SlotName.user, async function() {\n        const selector = `slot[name=\"${SlotName.user}\"]`;\n\n        expect(element?.shadowRoot?.querySelector(selector))\n            .to.be.ok;\n    });\n});","import { expect } from 'chai';\nimport * as faker from 'faker';\nimport { EventName, IUser, IAddUserEventMessage, Selector } from '../types';\nimport VamtigerUserRegistry, { name } from '../element';\nimport {removeUsers} from './browser';\n\nconst { VamtigerBrowserMethod } = window;\nconst { loadScript } = VamtigerBrowserMethod;\n\nexport default () => describe('dispatch custom events', function () {\n    const element = document.body.querySelector<VamtigerUserRegistry>(name);\n    const user: IUser = {\n        id: 0,\n        name: faker.name.firstName(),\n        surname: faker.name.lastName(),\n        email: faker.internet.email(),\n        position: faker.name.jobTitle()\n    }\n\n    after(removeUsers);\n\n    describe(`${EventName.connected}`, function () {\n        it('element added to DOM ', async function() {return new Promise((resolve, reject) => {\n            const element = document.createElement(name);\n\n            element.addEventListener(EventName.connected, () => {\n                expect(element.parentElement).to.equal(document.body);\n\n                element.parentElement?.removeChild(element);\n\n                resolve();\n            });\n\n            document.body.appendChild(element);\n        })});\n    });\n\n    describe(`${EventName.userAdded}`, function () {\n        it.skip('user element added to DOM ', function() {return new Promise(resolve => {\n            element?.addEventListener(EventName.userAdded, ({detail}: CustomEventInit<IAddUserEventMessage>) => {\n                expect(detail?.user).to.eq(user);\n\n                resolve();\n            });\n\n            element?.dispatchEvent(new CustomEvent(EventName.addUser, {\n                detail: {user}\n            }));\n        })});\n    });\n});","import { expect } from 'chai';\nimport * as faker from 'faker';\nimport {getElement} from './browser';\nimport handleUser from '../handle-user';\nimport { IUser } from '../types';\n\nexport default () => describe('Test Mode', function () {\n    const element = getElement();\n    const numberOfRecords = 100;\n\n    it(`Fake Data: ${numberOfRecords} records`, async function () {\n        const users: IUser[] = new Array(numberOfRecords)\n            .fill(undefined)\n            .map((entry, index) => ({\n                id: index,\n                name: faker.name.firstName(),\n                surname: faker.name.lastName(),\n                email: faker.internet.email(),\n                position: faker.name.jobTitle()\n            }));\n\n        element && users.map(user => handleUser({element, user}));\n    });\n});"],"names":["VamtigerBrowserMethod","window","loadScript","StringConstant","Selector","EventName","RequestMethod","SlotName","nothing","template","document","createElement","templateHtml","html","join","innerHTML","params","selector","attributes","properties","attributesKeys","Object","keys","templateElement","content","querySelector","currentTemplate","cloneNode","assign","forEach","key","setAttribute","eventParams","bubbles","idleTimeout","CustomEvent","connected","clickEventName","ontouchstart","requestIdleCallback","self","handleUser","element","user","name","surname","email","userTemplate","Array","from","values","some","id","userElement","getTemplate","slot","set","appendChild","dispatchEvent","userAdded","detail","addEventListener","dataset","hover","shadowRoot","overlay","overlayDataset","confirm","deleteUserElement","confirmDelete","intersectionObserver","css","Promise","all","href","map","catch","console","error","getElement","body","removeUsers","querySelectorAll","removeChild","delete","setup","describe","before","src","it","script","head","expect","HTMLScriptElement","to","be","true","resolve","after","parentElement","headerImage","ok","headerCapation","action","slots","faker.name","firstName","lastName","faker.internet","position","jobTitle","reject","equal","skip","eq","addUser","users","fill","undefined","entry","index","setTimeout","fakeData","run"],"mappings":"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"}